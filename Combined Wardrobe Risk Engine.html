<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Combined Wardrobing Risk Engine - Full System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
        }
        
        .section-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.07);
            border: 1px solid #e5e7eb;
        }
        
        .score-display {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 32px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(99, 102, 241, 0.4);
        }
        
        .decision-ir { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .decision-ph { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); }
        .decision-ph-rc { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .decision-ph-rc-e { background: linear-gradient(135deg, #f97316 0%, #ea580c 100%); }
        .decision-phv-rc-e { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        .decision-hr { background: linear-gradient(135deg, #7c2d12 0%, #991b1b 100%); }
        .decision-nr { background: linear-gradient(135deg, #450a0a 0%, #1f2937 100%); }
        
        .input-group label {
            display: block;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .input-group select, .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .input-group select:focus, .input-group input:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .calculate-btn {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 18px 32px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 18px;
            border: none;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }
        
        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(99, 102, 241, 0.4);
        }
        
        .calculate-btn:active {
            transform: translateY(0);
        }
        
        .breakdown-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 16px;
            background: #f8fafc;
            border-radius: 8px;
            margin-bottom: 8px;
            border-left: 4px solid #6366f1;
        }
        
        .breakdown-item span:first-child {
            font-weight: 500;
            color: #374151;
        }
        
        .breakdown-item span:last-child {
            font-weight: 700;
            color: #6366f1;
        }
        
        .disclaimer {
            background: #fef3c7;
            border: 2px solid #fbbf24;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 24px;
            display: flex;
            gap: 12px;
            align-items: start;
        }
        
        .disclaimer-icon {
            color: #f59e0b;
            flex-shrink: 0;
        }
        
        .disclaimer-text {
            color: #92400e;
            font-size: 13px;
            line-height: 1.5;
        }

        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }

        .matrix-table th {
            background: #1e293b;
            color: white;
            padding: 12px;
            font-weight: 700;
            font-size: 13px;
            text-align: center;
            border: 2px solid #334155;
        }

        .matrix-table td {
            padding: 14px;
            text-align: center;
            font-weight: 700;
            font-size: 13px;
            border: 2px solid #e5e7eb;
        }

        .matrix-ir { background: #d1fae5; color: #065f46; }
        .matrix-ph { background: #dbeafe; color: #1e40af; }
        .matrix-ph-rc { background: #fef3c7; color: #92400e; }
        .matrix-ph-rc-e { background: #fed7aa; color: #9a3412; }
        .matrix-phv-rc-e { background: #fecaca; color: #7f1d1d; }
        .matrix-hr { background: #fca5a5; color: #450a0a; }
        .matrix-nr { background: #374151; color: white; }

        .matrix-current {
            border: 4px solid #6366f1 !important;
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.2);
            transform: scale(1.05);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: #374151;
        }

        .legend-box {
            width: 16px;
            height: 16px;
            border-radius: 4px;
            border: 1px solid #d1d5db;
        }

        .tier-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            margin-left: 8px;
        }

        .tier-c1 { background: #d1fae5; color: #065f46; }
        .tier-c2 { background: #dbeafe; color: #1e40af; }
        .tier-c3 { background: #fed7aa; color: #9a3412; }
        .tier-c4 { background: #fca5a5; color: #7f1d1d; }

        .tier-p1 { background: #e0e7ff; color: #3730a3; }
        .tier-p2 { background: #fef3c7; color: #92400e; }
        .tier-p3 { background: #fed7aa; color: #9a3412; }
        .tier-p4 { background: #fca5a5; color: #7f1d1d; }
    </style>
</head>
<body class="p-6">

    <div class="max-w-7xl mx-auto">
        
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-5xl font-black text-white mb-3"> Combined Wardrobing Risk Engine</h1>
            <p class="text-white/90 text-lg">Customer + Product Risk = Final Decision Matrix</p>
        </div>

        <!-- Disclaimer -->
        <div class="disclaimer">
            <div class="disclaimer-icon">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
            </div>
            <div class="disclaimer-text">
                <strong>Demo Mode:</strong> This is a comprehensive testing interface combining both customer and product risk engines. In production, all data will be automatically fetched from backend systems (customer history, product metadata, payment records etc) and processed in real-time at return initiation.
            </div>
        </div>

        <div class="grid lg:grid-cols-3 gap-6">
            
            <!-- Column 1: Customer Risk -->
            <div>
                <div class="section-card">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span class="w-10 h-10 bg-purple-100 text-purple-600 rounded-full flex items-center justify-center text-sm font-bold">üë§</span>
                        Customer Risk Score
                    </h2>
                    
                    <div class="input-group mb-3">
                        <label>Return Rate by Volume</label>
                        <select id="returnVolume" onchange="updateScores()">
                            <option value="0">0-20%</option>
                            <option value="4">21-35%</option>
                            <option value="8">35-50%</option>
                            <option value="12">51-70%</option>
                            <option value="15">&gt;70%</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <label>Return Rate by Value</label>
                        <select id="returnValue" onchange="updateScores()">
                            <option value="0">0-20%</option>
                            <option value="4">21-35%</option>
                            <option value="8">35-50%</option>
                            <option value="12">51-70%</option>
                            <option value="15">&gt;70%</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <label>Refund Method Risk</label>
                        <select id="refundMethod" onchange="updateScores()">
                            <option value="0">Wallet/Store Credit</option>
                            <option value="4">Gift Card</option>
                            <option value="7">Same UPI/Bank</option>
                            <option value="10">Different UPI/Bank</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <label>Device Sharing Risk</label>
                        <select id="deviceSharing" onchange="updateScores()">
                            <option value="0">Only 1 account</option>
                            <option value="2">2 accounts</option>
                            <option value="4">3-5 accounts</option>
                            <option value="6">5+ accounts</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <label>QC Failures</label>
                        <select id="qcFailures" onchange="updateScores()">
                            <option value="0">All passed</option>
                            <option value="4">1 failed</option>
                            <option value="7">2 failed</option>
                            <option value="10">3+ failed</option>
                        </select>
                    </div>

                    <div class="bg-purple-50 p-4 rounded-xl border border-purple-200 mt-4">
                        <div class="text-sm text-purple-700 font-semibold mb-2">Customer Score</div>
                        <div class="text-4xl font-black text-purple-600" id="customerScore">0</div>
                        <div class="text-sm font-bold mt-2" id="customerTier">Tier: C1 Low</div>
                    </div>
                </div>
            </div>

            <!-- Column 2: Product Risk -->
            <div>
                <div class="section-card">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span class="w-10 h-10 bg-pink-100 text-pink-600 rounded-full flex items-center justify-center text-sm font-bold">üì¶</span>
                        Product Risk Score
                    </h2>
                    
                    <div class="input-group mb-3">
                        <label>Category Risk</label>
                        <select id="categoryRisk" onchange="updateScores()">
                            <option value="3">Low-risk (Innerwear, Essentials)</option>
                            <option value="12">Medium-risk (Casual, Tops, Dresses)</option>
                            <option value="25">High-risk (Lehenga, Ethnic, Party wear)</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <label>Season/Event Risk</label>
                        <select id="seasonRisk" onchange="updateScores()">
                            <option value="5">Neutral season</option>
                            <option value="15">Wedding Season</option>
                            <option value="25">Festival Season</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <label>Price Band</label>
                        <select id="priceBand" onchange="updateScores()">
                            <option value="0">Below ‚Çπ500</option>
                            <option value="6">‚Çπ500 - ‚Çπ800</option>
                            <option value="10">‚Çπ800 - ‚Çπ1500</option>
                            <option value="20">‚Çπ1500 - ‚Çπ5000</option>
                            <option value="4">Above ‚Çπ5000</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <label>SKU Return Rate</label>
                        <select id="skuReturnRate" onchange="updateScores()">
                            <option value="0">&lt;10%</option>
                            <option value="6">10-20%</option>
                            <option value="12">21-30%</option>
                            <option value="20">&gt;30%</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <label>Shark Tag Protection</label>
                        <select id="tagProtection" onchange="updateScores()">
                            <option value="0">Can be applied & IS used</option>
                            <option value="6">Can be applied but NOT used</option>
                            <option value="10">CANNOT be applied</option>
                        </select>
                    </div>

                    <div class="bg-pink-50 p-4 rounded-xl border border-pink-200 mt-4">
                        <div class="text-sm text-pink-700 font-semibold mb-2">Product Score</div>
                        <div class="text-4xl font-black text-pink-600" id="productScore">0</div>
                        <div class="text-sm font-bold mt-2" id="productTier">Tier: P1 Low</div>
                    </div>
                </div>
            </div>

            <!-- Column 3: Final Decision -->
            <div>
                <div class="section-card">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span class="w-10 h-10 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center text-sm font-bold">‚öñÔ∏è</span>
                        Final Decision
                    </h2>

                    <div class="score-display mb-4" id="finalDecisionCard">
                        <div class="text-sm font-semibold mb-2 opacity-90">COMBINED SCORE</div>
                        <div class="text-5xl font-black mb-3" id="finalScore">0</div>
                        <div class="text-xl font-bold mb-2" id="decisionCode">IR</div>
                        <div class="text-sm opacity-90" id="decisionText">Instant Return</div>
                    </div>

                    <div class="bg-white p-4 rounded-xl border border-gray-200">
                        <h3 class="text-sm font-bold text-gray-800 mb-3">Action Required</h3>
                        <div id="actionDetails" class="text-sm text-gray-600 leading-relaxed"></div>
                    </div>
                </div>

                <button onclick="calculateFinal()" class="calculate-btn mt-4">
                    üéØ Calculate Final Decision
                </button>
            </div>

        </div>

        <!-- Decision Matrix -->
        <div class="section-card mt-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">üìä Decision Matrix Visualization</h2>
            
            <table class="matrix-table">
                <thead>
                    <tr>
                        <th>Customer ‚Üí / Product ‚Üì</th>
                        <th>C1 Low<br/><span class="text-xs font-normal">(0-25)</span></th>
                        <th>C2 Medium<br/><span class="text-xs font-normal">(26-55)</span></th>
                        <th>C3 High<br/><span class="text-xs font-normal">(56-75)</span></th>
                        <th>C4 Severe<br/><span class="text-xs font-normal">(76-100)</span></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th>P1 Low<br/><span class="text-xs font-normal">(0-25)</span></th>
                        <td class="matrix-ir" id="cell-p1-c1">IR</td>
                        <td class="matrix-ph" id="cell-p1-c2">PH</td>
                        <td class="matrix-ph-rc" id="cell-p1-c3">PH + RC</td>
                        <td class="matrix-hr" id="cell-p1-c4">HR</td>
                    </tr>
                    <tr>
                        <th>P2 Medium<br/><span class="text-xs font-normal">(26-55)</span></th>
                        <td class="matrix-ph" id="cell-p2-c1">PH</td>
                        <td class="matrix-ph-rc" id="cell-p2-c2">PH + RC</td>
                        <td class="matrix-ph-rc-e" id="cell-p2-c3">PH + RC + E</td>
                        <td class="matrix-hr" id="cell-p2-c4">HR</td>
                    </tr>
                    <tr>
                        <th>P3 High<br/><span class="text-xs font-normal">(56-75)</span></th>
                        <td class="matrix-ph-rc" id="cell-p3-c1">PH + RC</td>
                        <td class="matrix-ph-rc-e" id="cell-p3-c2">PH + RC + E</td>
                        <td class="matrix-phv-rc-e" id="cell-p3-c3">PH+V + RC + E</td>
                        <td class="matrix-nr" id="cell-p3-c4">NR</td>
                    </tr>
                    <tr>
                        <th>P4 Severe<br/><span class="text-xs font-normal">(76-100)</span></th>
                        <td class="matrix-hr" id="cell-p4-c1">HR</td>
                        <td class="matrix-hr" id="cell-p4-c2">HR</td>
                        <td class="matrix-nr" id="cell-p4-c3">NR</td>
                        <td class="matrix-nr" id="cell-p4-c4">NR</td>
                    </tr>
                </tbody>
            </table>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mt-6">
                <div class="legend-item">
                    <div class="legend-box matrix-ir"></div>
                    <span><strong>IR</strong> = Instant Return</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box matrix-ph"></div>
                    <span><strong>PH</strong> = Photos (3)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box matrix-ph-rc"></div>
                    <span><strong>RC</strong> = Return Charge</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box matrix-ph-rc-e"></div>
                    <span><strong>E</strong> = Extra Fee</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box matrix-phv-rc-e"></div>
                    <span><strong>PH+V</strong> = Photos + Video</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box matrix-hr"></div>
                    <span><strong>HR</strong> = Human Review</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box matrix-nr"></div>
                    <span><strong>NR</strong> = No Return Allowed</span>
                </div>
            </div>
        </div>

    </div>

    <script>
        let customerScoreVal = 0;
        let productScoreVal = 0;

        function updateScores() {
            // Customer Score Components
            const returnVolume = parseInt(document.getElementById('returnVolume').value);
            const returnValue = parseInt(document.getElementById('returnValue').value);
            const refundMethod = parseInt(document.getElementById('refundMethod').value);
            const deviceSharing = parseInt(document.getElementById('deviceSharing').value);
            const qcFailures = parseInt(document.getElementById('qcFailures').value);
            
            customerScoreVal = returnVolume + returnValue + refundMethod + deviceSharing + qcFailures;
            document.getElementById('customerScore').textContent = customerScoreVal;

            // Customer Tier
            let customerTier, customerTierClass;
            if (customerScoreVal <= 25) {
                customerTier = "C1 Low";
                customerTierClass = "tier-c1";
            } else if (customerScoreVal <= 55) {
                customerTier = "C2 Medium";
                customerTierClass = "tier-c2";
            } else if (customerScoreVal <= 75) {
                customerTier = "C3 High";
                customerTierClass = "tier-c3";
            } else {
                customerTier = "C4 Severe";
                customerTierClass = "tier-c4";
            }
            document.getElementById('customerTier').innerHTML = `Tier: <span class="tier-badge ${customerTierClass}">${customerTier}</span>`;

            // Product Score Components
            const categoryRisk = parseInt(document.getElementById('categoryRisk').value);
            const seasonRisk = parseInt(document.getElementById('seasonRisk').value);
            const priceBand = parseInt(document.getElementById('priceBand').value);
            const skuReturnRate = parseInt(document.getElementById('skuReturnRate').value);
            const tagProtection = parseInt(document.getElementById('tagProtection').value);

            const categorySeasonScore = Math.round((categoryRisk * seasonRisk) / 12.5);
            productScoreVal = categorySeasonScore + priceBand + skuReturnRate + tagProtection;
            document.getElementById('productScore').textContent = productScoreVal;

            // Product Tier
            let productTier, productTierClass;
            if (productScoreVal <= 25) {
                productTier = "P1 Low";
                productTierClass = "tier-p1";
            } else if (productScoreVal <= 55) {
                productTier = "P2 Medium";
                productTierClass = "tier-p2";
            } else if (productScoreVal <= 75) {
                productTier = "P3 High";
                productTierClass = "tier-p3";
            } else {
                productTier = "P4 Severe";
                productTierClass = "tier-p4";
            }
            document.getElementById('productTier').innerHTML = `Tier: <span class="tier-badge ${productTierClass}">${productTier}</span>`;
        }

        function calculateFinal() {
            updateScores();

            const finalScore = customerScoreVal + productScoreVal;
            document.getElementById('finalScore').textContent = finalScore;

            // Determine Customer and Product Tiers
            let custTier, prodTier;
            
            if (customerScoreVal <= 25) custTier = 'c1';
            else if (customerScoreVal <= 55) custTier = 'c2';
            else if (customerScoreVal <= 75) custTier = 'c3';
            else custTier = 'c4';

            if (productScoreVal <= 25) prodTier = 'p1';
            else if (productScoreVal <= 55) prodTier = 'p2';
            else if (productScoreVal <= 75) prodTier = 'p3';
            else prodTier = 'p4';

            // Decision Matrix Lookup
            const decisionMatrix = {
                'p1-c1': { code: 'IR', text: 'Instant Return', class: 'decision-ir', action: '‚úÖ Approve return immediately without any verification. Standard 7-14 day return window. No additional charges.' },
                'p1-c2': { code: 'PH', text: 'Photos Required (3)', class: 'decision-ph', action: 'üì∏ Request 3 photos (front, back, tags). Basic verification. Standard return window.' },
                'p1-c3': { code: 'PH + RC', text: 'Photos + Return Charge', class: 'decision-ph-rc', action: 'üì∏ Require 3 photos + Apply return charge. Manual QC review.' },
                'p1-c4': { code: 'HR', text: 'Human Review Required', class: 'decision-hr', action: 'üë§ Escalate to fraud team. Full account audit. Conditional approval only.' },
                
                'p2-c1': { code: 'PH', text: 'Photos Required (3)', class: 'decision-ph', action: 'üì∏ Request 3 photos (front, back, tags). Basic verification. Standard return window.' },
                'p2-c2': { code: 'PH + RC', text: 'Photos + Return Charge', class: 'decision-ph-rc', action: 'üì∏ Require 3 photos + Apply return charge. Enhanced QC.' },
                'p2-c3': { code: 'PH + RC + E', text: 'Photos + Charges + Extra Fee', class: 'decision-ph-rc-e', action: 'üì∏ Require 3 photos + Apply return charge + Extra processing fee. Senior team review.' },
                'p2-c4': { code: 'HR', text: 'Human Review Required', class: 'decision-hr', action: 'üë§ Escalate to fraud prevention team. Possible account restriction.' },
                
                'p3-c1': { code: 'PH + RC', text: 'Photos + Return Charge', class: 'decision-ph-rc', action: 'üì∏ Require 3 photos + Apply return charge. Enhanced QC.' },
                'p3-c2': { code: 'PH + RC + E', text: 'Photos + Charges + Extra Fee', class: 'decision-ph-rc-e', action: 'üì∏ Require 3 photos + Apply return charge + Extra fee. Strict doorstep QC.' },
                'p3-c3': { code: 'PH+V + RC + E', text: 'Photos + Video + Charges + Extra', class: 'decision-phv-rc-e', action: 'üé• Mandatory video proof + 3 photos + Apply return charge + Extra fee. Tamper-proof bag required. Senior approval.' },
                'p3-c4': { code: 'NR', text: 'No Return Allowed', class: 'decision-nr', action: 'üö´ Return request BLOCKED. Exchange-only option. Legal disclaimer. Account flagged.' },
                
                'p4-c1': { code: 'HR', text: 'Human Review Required', class: 'decision-hr', action: 'üë§ Senior fraud team review. Full documentation required. Conditional approval with restrictions.' },
                'p4-c2': { code: 'HR', text: 'Human Review Required', class: 'decision-hr', action: 'üë§ Escalate to fraud prevention team. Extensive verification. Possible denial.' },
                'p4-c3': { code: 'NR', text: 'No Return Allowed', class: 'decision-nr', action: 'üö´ Return request BLOCKED. Exchange-only. Account under review for suspension.' },
                'p4-c4': { code: 'NR', text: 'No Return Allowed', class: 'decision-nr', action: 'üö´ Return DENIED. Permanent flag on account. Legal team consultation. Consider account ban.' }
            };

            const cellKey = `${prodTier}-${custTier}`;
            const decision = decisionMatrix[cellKey];

            // Update decision card
            const decisionCard = document.getElementById('finalDecisionCard');
            decisionCard.className = `score-display mb-4 ${decision.class}`;
            document.getElementById('decisionCode').textContent = decision.code;
            document.getElementById('decisionText').textContent = decision.text;
            document.getElementById('actionDetails').textContent = decision.action;

            // Highlight cell in matrix
            document.querySelectorAll('.matrix-table td').forEach(cell => {
                cell.classList.remove('matrix-current');
            });
            document.getElementById(`cell-${cellKey}`).classList.add('matrix-current');

            // Scroll to matrix
            document.querySelector('.matrix-table').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Initialize
        updateScores();
    </script>

</body>
</html>
